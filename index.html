<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VRCキャロムビリヤード部 | 公式ホームページ</title>
  <meta name="description" content="VRChatでキャロムビリヤードを楽しむコミュニティ。練習会・月例大会・リーグ戦・講座・FargoRate成り上がり杯などの活動情報を掲載。" />
  <style>
    :root{
      --bg:#0b1220;
      --card:#121b2e;
      --text:#eaf0ff;
      --muted:#b8c3e6;
      --accent:#7dd3fc;
      --line:rgba(255,255,255,.12);
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: "游ゴシック体","Yu Gothic","Hiragino Kaku Gothic ProN",Meiryo,sans-serif;
      background: radial-gradient(1200px 700px at 30% -10%, #1b3a6b 0%, var(--bg) 55%);
      color:var(--text);
    }
    a{ color:var(--accent); text-decoration:none; }
    a:hover{ text-decoration:underline; }

    /* Header / Hero */
    .hero{
      position:relative;
      overflow:hidden;
      border-bottom:1px solid var(--line);
      background:#0a1730;
    }
    .hero-banner{
      display:block;
      width:100%;
      height:auto;
      max-height: 360px;
      object-fit:cover;
      filter: saturate(1.05) contrast(1.02);
    }
    .hero-inner{
      position:relative;
      max-width:1100px;
      margin:0 auto;
      padding:18px 16px 22px;
      display:flex;
      gap:16px;
      align-items:center;
    }
    .logo{
      width:92px;
      height:92px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(0,0,0,.15);
      flex:0 0 auto;
    }
    .title h1{
      margin:0;
      font-size:28px;
      letter-spacing:.02em;
    }
    .title p{
      margin:6px 0 0;
      color:var(--muted);
      line-height:1.5;
    }
    .quicklinks{
      margin-top:10px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border:1px solid var(--line);
      border-radius:999px;
      background:rgba(255,255,255,.06);
      color:var(--text);
      text-decoration:none;
      font-size:14px;
    }
    .pill:hover{ background:rgba(255,255,255,.10); text-decoration:none; }

    /* Nav */
    nav{
      position:sticky;
      top:0;
      z-index:5;
      background:rgba(10,23,48,.92);
      backdrop-filter: blur(8px);
      border-bottom:1px solid var(--line);
    }
    nav .nav-inner{
      max-width:1100px;
      margin:0 auto;
      padding:10px 16px;
      display:flex;
      gap:14px;
      flex-wrap:wrap;
      align-items:center;
    }
    nav a{
      color:var(--text);
      opacity:.9;
      font-size:14px;
      padding:6px 10px;
      border-radius:10px;
    }
    nav a:hover{ background:rgba(255,255,255,.07); text-decoration:none; }

    /* Main */
    main{
      max-width:1100px;
      margin:0 auto;
      padding:18px 16px 44px;
    }
    section{ margin-top:18px; }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius:16px;
      padding:18px;
    }
    h2{
      margin:0 0 10px;
      font-size:20px;
      letter-spacing:.02em;
    }
    .muted{ color:var(--muted); }
    ul{ margin:10px 0 0 1.1em; }
    li{ margin:.35em 0; }

    /* History filters */
    .filters{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      margin:10px 0 12px;
    }
    .btn{
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      color:var(--text);
      padding:8px 10px;
      border-radius:12px;
      cursor:pointer;
      font-size:14px;
    }
    .btn[aria-pressed="true"]{
      background:rgba(125,211,252,.18);
      border-color:rgba(125,211,252,.45);
    }
    .search{
      flex:1 1 220px;
      display:flex;
      gap:8px;
      align-items:center;
    }
    .search input{
      width:100%;
      padding:9px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.22);
      color:var(--text);
      outline:none;
    }
    .list{
      margin:0;
      padding:0;
      list-style:none;
      display:grid;
      gap:10px;
    }
    .item{
      border:1px solid var(--line);
      border-radius:14px;
      background:rgba(0,0,0,.18);
      padding:12px 12px 11px;
    }
    .item .top{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:baseline;
      justify-content:space-between;
    }
    .badge{
      font-size:12px;
      color:var(--muted);
      border:1px solid var(--line);
      padding:3px 8px;
      border-radius:999px;
      background:rgba(255,255,255,.05);
      white-space:nowrap;
    }
    .item h3{
      margin:6px 0 0;
      font-size:16px;
      font-weight:700;
    }
    .item .meta{
      margin-top:6px;
      color:var(--muted);
      font-size:14px;
      line-height:1.5;
    }

    /* Gallery */
    .gallery-grid{
      margin-top:12px;
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap:10px;
    }
    .thumb{
      display:block;
      border:1px solid var(--line);
      border-radius:14px;
      overflow:hidden;
      background:rgba(0,0,0,.18);
      cursor:pointer;
    }
    .thumb img{
      width:100%;
      height:160px;
      object-fit:cover;
      display:block;
      transition: transform .12s ease;
    }
    .thumb:hover img{ transform: scale(1.02); }
    .thumb .cap{
      padding:8px 10px;
      font-size:13px;
      color:var(--muted);
      border-top:1px solid var(--line);
      line-height:1.35;
    }

    .lightbox{
      position:fixed;
      inset:0;
      z-index:50;
      display:none;
      align-items:center;
      justify-content:center;
      padding:20px;
      background:rgba(0,0,0,.78);
    }
    .lightbox.open{ display:flex; }
    .lightbox-inner{
      position:relative;
      max-width:min(1100px, 96vw);
      max-height:88vh;
    }
    .lightbox img{
      width:100%;
      height:auto;
      max-height:88vh;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.16);
      background:rgba(0,0,0,.35);
      display:block;
    }
    .lightbox .close{
      position:absolute;
      top:-12px;
      right:-12px;
      width:40px;
      height:40px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.22);
      background:rgba(10,23,48,.9);
      color:var(--text);
      cursor:pointer;
      font-size:20px;
      line-height:38px;
      text-align:center;
    }
    .lightbox .close:hover{ background:rgba(255,255,255,.10); }

    footer{
      margin-top:26px;
      color:var(--muted);
      font-size:12px;
      text-align:center;
      padding-top:18px;
      border-top:1px solid var(--line);
    }

    @media (max-width:720px){
      .hero-inner{ align-items:flex-start; }
      .logo{ width:76px; height:76px; border-radius:16px; }
      .title h1{ font-size:24px; }
    }
  
    /* リーグ戦などの添付画像（サムネ：だいたい1/4サイズ） */
.item-imgs{
  display:flex;
  gap: 12px;
  flex-wrap: wrap;
  margin-top: 10px;
}
.item-imgs .img-btn{
  appearance:none;
  border:0;
  background:transparent;
  padding:0;
  cursor:pointer;
  width: 25%;
  max-width: 220px;
  min-width: 120px;
}
.item-imgs img{
  width:100%;
  height:auto;
  border-radius: 14px;
  display:block;
  box-shadow: 0 10px 30px rgba(0,0,0,.25);
}
@media (max-width:720px){
  .item-imgs .img-btn{
    width: 48%;
    max-width:none;
    min-width: 0;
  }
}

    /* Videos */
    
    .video-thumb{
      position:absolute;
      inset:0;
      display:block;
      color:inherit;
      text-decoration:none;
      background:#000;
    }
    .video-thumb img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      filter:saturate(1.02) contrast(1.03);
    }
    .video-thumb .play{
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      background:linear-gradient(180deg, rgba(0,0,0,.20), rgba(0,0,0,.35));
    }
    .video-thumb .play:before{
      content:"";
      width:64px;
      height:44px;
      border-radius:12px;
      background:rgba(0,0,0,.55);
      border:1px solid rgba(255,255,255,.20);
      box-shadow:0 10px 30px rgba(0,0,0,.35);
    }
    .video-thumb .play:after{
      content:"";
      position:absolute;
      width:0;
      height:0;
      border-left:16px solid rgba(255,255,255,.92);
      border-top:10px solid transparent;
      border-bottom:10px solid transparent;
      transform:translateX(4px);
    }
    .video-thumb:hover img{ filter:saturate(1.05) contrast(1.05); }

.video-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(260px, 1fr));
      gap:14px;
      margin-top:14px;
    }
    .video-card{
      background:rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.10);
      border-radius:16px;
      overflow:hidden;
    }
    .ratio{
      position:relative;
      width:100%;
      aspect-ratio:16/9;
      background:rgba(0,0,0,.25);
    }
    .ratio iframe{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      border:0;
    }
    .video-meta{
      padding:12px 12px 14px;
    }
    .video-title{
      font-weight:800;
      margin-bottom:6px;
    }
    .video-link{
      color:rgba(255,255,255,.82);
      word-break:break-all;
      font-size:13px;
      text-decoration:underline;
    }


    /* FAQ */
    .faq details{
      border:1px solid var(--line);
      border-radius:14px;
      padding: 12px 14px;
      background: rgba(255,255,255,0.03);
    }
    .faq details + details{ margin-top: 10px; }
    .faq summary{
      cursor:pointer;
      font-weight:800;
      outline:none;
    }
    .faq .answer{ margin-top: 10px; line-height:1.7; }
</style>
</head>
<body>
  <header class="hero">
    <!-- バナー（上部・下部の余白はトリミング済み画像を使用） -->
    <img class="hero-banner" src="assets/banner.png" alt="VRC CAROM BILLIARDS CLUB バナー" />
    <div class="hero-inner">
      <img class="logo" src="assets/logo.png" alt="VRCキャロムビリヤード部 ロゴ" />
      <div class="title">
        <h1>VRCキャロムビリヤード部</h1>
        <p>VRChatでキャロムビリヤードを楽しむコミュニティ（設立：2025年2月 / 主催：つかぽん）</p>
        <div class="quicklinks">
          <a class="pill" href="https://x.com/VRC_carom" target="_blank" rel="noopener">公式X（@VRC_carom）</a>
          <a class="pill" href="https://discord.gg/nPfYDb7tsj" target="_blank" rel="noopener">Discord</a>
          <a class="pill" href="https://vrc.group/CAROM.6269" target="_blank" rel="noopener">VRChatグループ</a>
        </div>
      </div>
    </div>
  </header>

  <nav>
    <div class="nav-inner">
      <a href="#about">概要</a>
      <a href="#activities">活動内容</a>
      <a href="#history">過去のイベント</a>
      <a href="#gallery">ギャラリー</a>
      <a href="#join">参加方法</a>
      <a href="#videos">動画</a>
      <a href="#faq">FAQ</a>
    </div>
  </nav>

  <main>
    <section id="about" class="card">
      <h2>概要</h2>
      <p class="muted">
        ポケットのない「キャロム台」の遊び（スリークッション、四つ玉、3ボール等）を中心に、
        練習会・大会・講座・リーグ戦を開催しています。最近では、FargoRateを使ったスリークッションの
        <strong>成り上がり杯</strong>も運用中です。
      </p>
    </section>

    <section id="activities" class="card">
      <h2>活動内容</h2>
      <ul>
        <li><strong>定期練習会：</strong>毎週木曜の夜に集まって練習・対戦（初心者歓迎）</li>
        <li><strong>月例大会：</strong>基本的に<strong>毎月第一金曜日</strong>にトーナメントを開催</li>
        <li><strong>講座：</strong>スリークッションの基礎〜次の一歩まで、テーマ別で開催</li>
        <li><strong>リーグ戦：</strong>期間を設けて総当たりで対戦（スリークッションリーグ等）</li>
        <li><strong>FargoRate 成り上がり杯：</strong>FargoRateを軸にした長期運用イベント（現在運用中）</li>
        <li><strong>対応ゲーム例：</strong>3ボール / 韓国式4ボール / 4ボール / バンドゲーム（1クッション） / スリークッション</li>
        <li><strong>新要素：</strong>ポケットテーブルを使った「<strong>カイルン</strong>」もプレー可能になりました</li>
      </ul>
      <p class="muted" style="margin-top:10px;">
        開催告知・参加募集・結果報告は、主に公式XとDiscordで行います。
      </p>
    </section>

    <section id="history" class="card">
      <h2>過去のイベント（トーナメント / 講座 / リーグ）</h2>
      <p class="muted">ボタンで種類を切り替え、キーワードで絞り込みできます（例：kuu00 / 4ball / リーグ）。</p>

      <div class="filters">
        <button class="btn" data-kind="tournaments" aria-pressed="true">トーナメント</button>
        <button class="btn" data-kind="lectures" aria-pressed="false">講座</button>
        <button class="btn" data-kind="leagues" aria-pressed="false">リーグ戦</button>
        <button class="btn" data-kind="ongoing" aria-pressed="false">運用中</button>

        <div class="search" style="margin-left:auto;">
          <input id="q" type="search" placeholder="検索（タイトル / 優勝者 / 講師 など）" />
        </div>
      </div>

      <ol id="historyList" class="list"></ol>
    </section>

    <section id="gallery" class="card">
      <h2>ギャラリー</h2>
      <p class="muted">
        画像はCloudinaryから配信しています（クリックで拡大）。
        追加したい場合は、下のスクリプト内の <code>gallery</code> に Public ID を追記してください。
      </p>
      <div id="galleryGrid" class="gallery-grid"></div>
    </section>

    <section id="join" class="card">
      <h2>参加方法</h2>
      <p class="muted">どなたでも参加歓迎です。まずは下記から参加しやすい入口をご利用ください。</p>
      <ul>
        <li>公式X：<a href="https://x.com/VRC_carom" target="_blank" rel="noopener">https://x.com/VRC_carom</a></li>
        <li>Discord：<a href="https://discord.gg/nPfYDb7tsj" target="_blank" rel="noopener">https://discord.gg/nPfYDb7tsj</a></li>
        <li>VRChatグループ：<a href="https://vrc.group/CAROM.6269" target="_blank" rel="noopener">https://vrc.group/CAROM.6269</a></li>
      </ul>
      <p class="muted" style="margin-top:10px;">トーナメントに参加するには事前登録が必要です。DiscordやXで告知するので、Googleフォーム（エントリーフォーム）でエントリーしてください。</p>

      <p class="muted" style="margin-top:10px;">
        ※イベント当日は、VRChat内で集合してそのまま参加できるスタイルです。告知はDiscord・Xをご確認ください。
      </p>
    </section>


    
    <section id="videos" class="card">
      <h2>動画</h2>
      <p class="muted">YouTubeで公開している関連動画です（クリックでYouTubeを開きます）。</p>

      <div class="video-grid">
        <div class="video-card">
          <div class="ratio">
            <a class="video-thumb" href="https://youtu.be/oja49ijZnd8" target="_blank" rel="noopener noreferrer" aria-label="VRC キャロムビリヤード部　スライドショー（YouTubeで開く）">
              <img src="https://i.ytimg.com/vi/oja49ijZnd8/hqdefault.jpg" alt="VRC キャロムビリヤード部　スライドショー サムネイル" loading="lazy">
              <span class="play" aria-hidden="true"></span>
            </a>
          </div>
          <div class="video-meta">
            <div class="video-title">VRC キャロムビリヤード部　スライドショー</div>
            <a class="video-link" href="https://youtu.be/oja49ijZnd8" target="_blank" rel="noopener noreferrer">https://youtu.be/oja49ijZnd8</a>
          </div>
        </div>
        <div class="video-card">
          <div class="ratio">
            <a class="video-thumb" href="https://youtu.be/_0ZMVB6lvTY" target="_blank" rel="noopener noreferrer" aria-label="vrchat スリークッションの特殊な取り方（YouTubeで開く）">
              <img src="https://i.ytimg.com/vi/_0ZMVB6lvTY/hqdefault.jpg" alt="vrchat スリークッションの特殊な取り方 サムネイル" loading="lazy">
              <span class="play" aria-hidden="true"></span>
            </a>
          </div>
          <div class="video-meta">
            <div class="video-title">vrchat スリークッションの特殊な取り方</div>
            <a class="video-link" href="https://youtu.be/_0ZMVB6lvTY" target="_blank" rel="noopener noreferrer">https://youtu.be/_0ZMVB6lvTY</a>
          </div>
        </div>
        <div class="video-card">
          <div class="ratio">
            <a class="video-thumb" href="https://youtu.be/DgG79SYBqac" target="_blank" rel="noopener noreferrer" aria-label="three cushion spirits（YouTubeで開く）">
              <img src="https://i.ytimg.com/vi/DgG79SYBqac/hqdefault.jpg" alt="three cushion spirits サムネイル" loading="lazy">
              <span class="play" aria-hidden="true"></span>
            </a>
          </div>
          <div class="video-meta">
            <div class="video-title">three cushion spirits</div>
            <a class="video-link" href="https://youtu.be/DgG79SYBqac" target="_blank" rel="noopener noreferrer">https://youtu.be/DgG79SYBqac</a>
          </div>
        </div>
        <div class="video-card">
          <div class="ratio">
            <a class="video-thumb" href="https://youtu.be/mRQy9C9HhxA" target="_blank" rel="noopener noreferrer" aria-label="#18 Napoleon hat（YouTubeで開く）">
              <img src="https://i.ytimg.com/vi/mRQy9C9HhxA/hqdefault.jpg" alt="#18 Napoleon hat サムネイル" loading="lazy">
              <span class="play" aria-hidden="true"></span>
            </a>
          </div>
          <div class="video-meta">
            <div class="video-title">#18 Napoleon hat</div>
            <a class="video-link" href="https://youtu.be/mRQy9C9HhxA" target="_blank" rel="noopener noreferrer">https://youtu.be/mRQy9C9HhxA</a>
          </div>
        </div>
      </div>
    </section>

    <section id="faq" class="card faq">
      <h2>FAQ よくある質問</h2>
      <p class="muted">回答は必要に応じて追記していきます。</p>

      <details>
        <summary>vrchatって何ですか？</summary>
        <div class="answer">
          <p>VRChat（ブイアールチャット）は、PCやVRヘッドセットで入れる<strong>ソーシャルVRプラットフォーム</strong>です。ワールド（世界）に入って、アバターで歩き回ったり、ボイスチャットで会話したり、ゲームやイベントに参加できます。</p>
          <p>VRがなくても<strong>PC（デスクトップ）だけで参加可能</strong>なので、まずはPCで雰囲気を見て、慣れてきたらVRで遊ぶ人も多いです。</p>
        </div>
      </details>

      <details>
        <summary>VRでのビリヤードはリアルのビリヤードと何が違うの？</summary>
        <div class="answer">
          <p>大きくは「体験のしかた」と「環境」の違いです。</p>
          <ul>
            <li><strong>距離感・フォーム</strong>：VRではキューを実際に持つわけではないため、フォームや構えはリアルと完全一致しません。その一方で、VRならではの感覚で「狙い」「厚み」「回転」「力加減」を練習できます。</li>
            <li><strong>物理・台の個性</strong>：VRの台はワールドごとに物理設定（転がり、クッション、摩擦など）が異なることがあります。代わりに、キャロム（3C/4B/1クッション等）に対応した台でルール練習や配置練習がしやすいのも特徴です。</li>
            <li><strong>集まりやすさ</strong>：移動が不要で集まりやすく、初心者でも参加しやすいのがVRの強みです。</li>
          </ul>
          <p>「リアルの完全な代替」ではなく、<strong>別競技として楽しい＋練習にもなる</strong>、というイメージが近いです。</p>
        </div>
      </details>

      <details>
        <summary>Fargoレートって何ですか？</summary>
        <div class="answer">
          <p>FargoRate（ファーゴレート）は、主にポケットビリヤードで使われる<strong>実力を数値化するレーティング</strong>の仕組みです。試合結果を積み重ねることで、相手との実力差を考慮しながらレートが更新され、近い実力同士のマッチメイクやハンデ設定の目安として使われます。</p>
          <p>VRCキャロムビリヤード部では、スリークッションでも「成り上がり杯」などで<strong>レートを目安にしたイベント運用</strong>を行っています（運用ルールはイベントごとに案内します）。</p>
        </div>
      </details>
    </section>

<footer>
      © VRCキャロムビリヤード部 / Since 2025
    </footer>
  </main>

  
  <script>
  (function(){
    "use strict";

    // ===== Cloudinary =====
    const CLOUD_NAME = "dlqrotrhj";

    // URLから Cloudinary 変換（軽量化・縮小）を差し込む
    function cldFromUrl(url, width){
      if(!url) return "";
      const marker = "/image/upload/";
      const i = url.indexOf(marker);
      if(i === -1) return url;
      const prefix = url.slice(0, i + marker.length);
      const rest   = url.slice(i + marker.length); // 例: v12345/abc.png
      const w = width ? `w_${width},` : "";
      return `${prefix}${w}f_auto,q_auto/${rest}`;
    }

    // Public ID からURLを作る（必要なら）
    function cldUrl(publicId, width){
      const w = width ? `w_${width},` : "";
      return `https://res.cloudinary.com/${CLOUD_NAME}/image/upload/${w}f_auto,q_auto/${publicId}`;
    }

    // ===== Utilities =====
    function normalize(s){
      return (s || "").toString().toLowerCase().replace(/\s+/g, "");
    }
    function escapeHtml(s){
      return (s ?? "").toString()
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/\"/g, "&quot;")
        .replace(/'/g, "&#39;");
    }

    // ===== Lightbox（ギャラリー/イベント共通）=====
    const lb = document.createElement("div");
    lb.className = "lightbox";
    lb.innerHTML = `
      <div class="lightbox-inner">
        <button class="close" aria-label="閉じる">×</button>
        <img alt="" />
      </div>
    `;
    document.body.appendChild(lb);

    const lbImg = lb.querySelector("img");
    const lbClose = lb.querySelector(".close");

    function openLightbox(src, alt){
      if(!src) return;
      lbImg.src = src;
      lbImg.alt = alt || "";
      lb.classList.add("open");
    }
    function closeLightbox(){
      lb.classList.remove("open");
      // 画像を外す（メモリ節約）
      lbImg.src = "";
      lbImg.alt = "";
    }
    lbClose.addEventListener("click", closeLightbox);
    lb.addEventListener("click", (e) => { if(e.target === lb) closeLightbox(); });
    document.addEventListener("keydown", (e) => { if(e.key === "Escape") closeLightbox(); });

    // ===== 過去イベントデータ =====
    const data = {
      tournaments: [
        { date: "2月7日",  title: "3ballトーナメント", winner: "貴＠ｓｃT" , img: "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765861946/1_brxcjv.png"},
        { date: "3月7日",  title: "韓国式4ballトーナメント", winner: "cheese" , img: "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765861946/2_whfhii.png"},
        { date: "4月4日",  title: "第1回バンドゲーム（1クッション）トーナメント", winner: "kuu00" , img: "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765863145/2_upkydx.png"},
        { date: "4月28日", title: "韓国式4ballペアマッチトーナメント", winner: "ミネラル麦茶 ＆ トリプルセブン" , img: "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765862208/3_awpm7u.png"},
        { date: "6月6日",  title: "スリークッショントーナメント", winner: "edamame3tubu" , img: "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765863145/3_ezhqn3.png"},
        { date: "7月4日",  title: "第1回4ballトーナメント", winner: "Ruba d6d4" , img: "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765861948/3_lgav9e.png"},
        { date: "7月31日", title: "第2回バンドゲーム（1クッション）トーナメント", winner: "kuu00" , img: "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765862438/6_xwleks.png"},
        { date: "9月5日",  title: "4ballペアマッチトーナメント", winner: "maAsa ＆ yuru" , img: "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765862210/4_ibjlys.png"},
        { date: "11月7日", title: "第3回バンドゲーム（1クッション）トーナメント", winner: "Ruba d6d4" , img: "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765862437/7_lo4zix.png"},
        { date: "12月5日", title: "第2回4ballトーナメント", winner: "貴＠ｓｃT" , img: "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765861948/4_xy8v2w.png"}
      ],
      lectures: [
        { date: "9月11日", title: "スリークッション講座「スリークッション　最初の一歩」", instructor: "int mint", img: "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765865685/3cushion-seminar1_qyrgmc.png" },
        { date: "10月3日", title: "スリークッション講座「スリークッション　次への一歩」", instructor: "int mint", img: "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765865704/3cushion-seminar2_q9ygfs.png" }
      ],
      leagues: [
        {
          date: "6月9日～7月17日",
          title: "第1回スリークッションリーグ",
          winner: "int mint",
          imgs: [
            "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765795920/2_mytd2z.png",
            "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765810892/winner_hm6pew.png"
          ]
        },
        {
          date: "9月18日～10月16日",
          title: "第2回スリークッションリーグ",
          winner: "int mint",
          imgs: [
            "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765795921/5_iuvrrm.png",
            "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765810994/winner_1_hqruhy.png"
          ]
        }
      ],
      ongoing: [
        { date: "10月22日～1月14日", title: "FargoRate 成り上がり杯", note: "現在運用中" }
      ]
    };

    const labels = {
      tournaments: "トーナメント",
      lectures: "講座",
      leagues: "リーグ戦",
      ongoing: "運用中"
    };

    // ===== 過去イベント描画 =====
    const listEl = document.getElementById("historyList");
    const qEl = document.getElementById("q");
    const btns = Array.from(document.querySelectorAll(".btn[data-kind]"));
    let currentKind = "tournaments";

    function renderHistory(){
      if(!listEl) return;

      const items = data[currentKind] || [];
      const q = normalize(qEl ? qEl.value : "");

      const filtered = items.filter(it => {
        const hay = normalize([it.date, it.title, it.winner, it.instructor, it.note].filter(Boolean).join(" "));
        return !q || hay.includes(q);
      });

      listEl.innerHTML = "";

      if(filtered.length === 0){
        const li = document.createElement("li");
        li.className = "item";
        li.innerHTML = '<div class="muted">該当する項目がありません。</div>';
        listEl.appendChild(li);
        return;
      }

      filtered.forEach(it => {
        const li = document.createElement("li");
        li.className = "item";

        const metaParts = [];
        if(it.winner) metaParts.push(`優勝者：${escapeHtml(it.winner)}`);
        if(it.instructor) metaParts.push(`講師：${escapeHtml(it.instructor)}`);
        if(it.note) metaParts.push(escapeHtml(it.note));

        const imgUrls = [];
        if(Array.isArray(it.imgs)) imgUrls.push(...it.imgs);
        if(it.img) imgUrls.unshift(it.img);

        const imgsHtml = imgUrls.length ? `
          <div class="item-imgs">
            ${imgUrls.map((u, idx) => {
              const thumb = cldFromUrl(u, 320);     // 小さめ（約1/4）
              const full  = cldFromUrl(u, 1600);    // 拡大表示
              const alt   = escapeHtml(`${it.title} (${idx+1})`);
              return `<button class="img-btn" type="button" data-full="${full}" data-alt="${alt}" aria-label="画像を拡大">
                        <img src="${thumb}" alt="${alt}" loading="lazy" />
                      </button>`;
            }).join("")}
          </div>
        ` : "";

        li.innerHTML = `
          <div class="top">
            <span class="badge">${labels[currentKind]} / ${escapeHtml(it.date)}</span>
          </div>
          <h3>${escapeHtml(it.title)}</h3>
          ${metaParts.length ? `<div class="meta">${metaParts.join("　")}</div>` : ""}
          ${imgsHtml}
        `;

        li.querySelectorAll(".img-btn").forEach(btn => {
          btn.addEventListener("click", () => openLightbox(btn.dataset.full, btn.dataset.alt || ""));
        });

        listEl.appendChild(li);
      });
    }

    // ボタン初期化
    btns.forEach(b => {
      b.addEventListener("click", () => {
        currentKind = b.dataset.kind;
        btns.forEach(x => x.setAttribute("aria-pressed", x === b ? "true" : "false"));
        renderHistory();
      });
    });
    if(qEl) qEl.addEventListener("input", renderHistory);

    // デフォルト：トーナメント表示
    btns.forEach(x => x.setAttribute("aria-pressed", x.dataset.kind === currentKind ? "true" : "false"));
    renderHistory();

    // ===== Gallery（Cloudinary）=====
    const gallery = [
      { id: "1_skqpf3", title: "日本語ポスター（旧）" },
      { url: "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765795485/8_td9pno.png", title: "日本語ポスター（新）" },
      { url: "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765819049/VRC%E3%82%AD%E3%83%A3%E3%83%AD%E3%83%A0%E3%83%93%E3%83%AA%E3%83%A4%E3%83%BC%E3%83%89%E9%83%A8_qjfwll.png", title: "英語ポスター" },
      { url: "https://res.cloudinary.com/dlqrotrhj/image/upload/v1765818267/VRC%E3%82%AD%E3%83%A3%E3%83%AD%E3%83%A0%E3%83%93%E3%83%AA%E3%83%A4%E3%83%BC%E3%83%89%E9%83%A8_o6jwbj.png", title: "韓国語ポスター" }
    ];

    const galleryGrid = document.getElementById("galleryGrid");

    function galleryItemUrl(item, width){
      if(item.url) return cldFromUrl(item.url, width);
      return cldUrl(item.id, width);
    }

    function renderGallery(){
      if(!galleryGrid) return;

      if(!gallery || gallery.length === 0){
        galleryGrid.innerHTML = '<div class="muted">（ギャラリー画像を追加するとここに表示されます）</div>';
        return;
      }
      galleryGrid.innerHTML = "";
      gallery.forEach((g) => {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "thumb";
        btn.style.textAlign = "left";

        const src = galleryItemUrl(g, 420);
        const full = galleryItemUrl(g, 1800);

        btn.innerHTML = `
          <img src="${src}" alt="${escapeHtml(g.title || "")}" loading="lazy" />
          <div class="cap">${escapeHtml(g.title || "")}</div>
        `;
        btn.addEventListener("click", () => openLightbox(full, g.title || ""));
        galleryGrid.appendChild(btn);
      });
    }

    renderGallery();
  })();
  </script>

</body>
</html>
